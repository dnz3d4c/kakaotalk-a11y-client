# 기여 가이드

## 커밋 메시지 규칙

### 형식
```
<타입>: <한글 설명>
<타입>(<스코프>): <한글 설명>
```

**본문은 거의 쓰지 않는다.** 제목만으로 충분히 이해되게 작성.

### 타입
| 타입 | 용도 | 스코프 예시 |
|------|------|------------|
| `feat` | 새 기능 | - |
| `fix` | 버그 수정 | - |
| `improve` | 기존 기능 개선 | - |
| `refactor` | 리팩토링 (기능 변경 없음) | - |
| `docs` | 문서만 변경 | `docs(USER_GUIDE):`, `docs(ARCHITECTURE):` |
| `chore` | 빌드/설정/의존성 | `chore(version):`, `chore(deps):`, `chore(build):` |
| `style` | 코드 스타일 (포맷팅) | - |
| `test` | 테스트 추가/수정 | - |

### 스코프 (선택사항)

세부 영역을 명시할 때 괄호로 표시. **docs, chore에서 권장.**

**docs 스코프**:
| 스코프 | 대상 |
|--------|------|
| `docs(USER_GUIDE):` | 사용자 가이드 |
| `docs(ARCHITECTURE):` | 아키텍처 문서 |
| `docs(CHANGELOG):` | 변경 이력 |
| `docs(CONTRIBUTING):` | 기여 가이드 |
| `docs(BUILD):` | 빌드/배포 문서 |

**chore 스코프**:
| 스코프 | 대상 |
|--------|------|
| `chore(version):` | 버전 업데이트 |
| `chore(deps):` | 의존성 변경 |
| `chore(build):` | 빌드 설정 |
| `chore(config):` | 설정 파일 |

### 타입 선택 기준

| 질문 | 답변 | 타입 |
|------|------|------|
| 이전에 없던 기능인가? | 예 | `feat` |
| 있던 기능이 더 나아졌나? | 예 | `improve` |
| 잘못된 동작을 고쳤나? | 예 | `fix` |
| 기능 변경 없이 코드만 정리했나? | 예 | `refactor` |

### fix vs improve 구분
- `fix`: 명확한 버그 수정 (잘못된 동작 → 올바른 동작)
- `improve`: 근본 원인 분석 후 최선책 적용 (성능, 안정성 개선)

### improve 메시지 형식

**필수 형식**: "~이/가 ~해짐" (결과 중심)

| 나쁜 예 (기술 중심) | 좋은 예 (결과 중심) |
|---------------------|---------------------|
| find_all_descendants 조기종료 | 이모지 감지 빨라짐 |
| CPU 스파이크 완화 | 메뉴 열 때 버벅임 줄어듦 |
| 이벤트 폴백 추가 | 포커스 추적 안정화 |
| 캐시 TTL 조정 | 메시지 목록 갱신 빨라짐 |

### AI 커밋 메시지 피하기

**나쁜 예 (AI 스타일):**
```
feat: 탭 메뉴 포커스 읽기 추가

- TabItemControl 처리 추가 (친구/채팅/더보기 탭)
- 선택 상태 포함 읽기 ("친구 탭 선택됨")
- 기타 ControlType TRACE 로깅 추가
```

**그나마 나은 예:**
```
feat: 탭 메뉴 선택 상태 읽기
```

**좋은 예 (사용자 관점):**
```
feat: 친구/채팅/더보기 탭 구분 가능
```

### 인간 친화적 메시지 원칙

1. **사용자가 뭘 할 수 있는지** - "탭 읽기 추가" → "탭 구분 가능"
2. **릴리즈 노트에 바로 쓸 수 있게** - 커밋 메시지 = 변경사항 요약
3. **기술 용어 제거** - Pattern, Control, Handler 등 생략
4. **본문은 거의 불필요** - 제목만으로 끝내기

### 핵심 vs 부수적 변경 구분

커밋 메시지는 **핵심 기능 변경**만 언급. 부수적 변경은 생략하거나 본문에.

| 구분 | 정의 | 예시 |
|------|------|------|
| 핵심 | 사용자 행동/경험이 달라짐 | 창 재사용, 새 단축키, 동작 변경 |
| 부수적 | 구현 세부사항, 코드 정리 | 음성 제거, 변수명 변경, 구분선 스타일 |

**체크**: "사용자가 이걸 알아야 하나?" → Yes면 핵심, No면 부수적

### 예시 비교

| 기술 중심 (나쁨) | 사용자 중심 (좋음) |
|-----------------|-------------------|
| 탭 메뉴 선택 상태 읽기 | 친구/채팅/더보기 탭 구분 가능 |
| 채팅방 진입 시 메시지 누락 수정 | 채팅방 들어갈 때 메시지 안 빠짐 |
| 팝업메뉴 CPU 스파이크 개선 | 우클릭 메뉴 빨라짐 |
| MessageMonitor pause/resume 패턴 적용 | 메뉴 열어도 메시지 안 끊김 |

### 예시
```
feat: 친구/채팅/더보기 탭 구분 가능
fix: 채팅방 들어갈 때 메시지 안 빠짐
improve: 우클릭 메뉴 반응 빨라짐
docs(USER_GUIDE): 단축키 설명 추가
docs(ARCHITECTURE): 모듈 구조 업데이트
chore(version): 0.2.4
chore(deps): accessible-output2 업데이트
```

### 커밋 단위
- 하나의 논리적 변경 = 하나의 커밋
- 작동하는 상태에서만 커밋
- 관련 없는 변경을 묶지 않기

### 커밋 시점
- 기능 구현 완료 시
- 버그 수정 완료 시
- 리팩토링 완료 시
- 문서 업데이트 완료 시

---

## CHANGELOG 작성 규칙

### 즉시 작성 규칙

코드 커밋 시 CHANGELOG의 `[Unreleased]` 섹션에 즉시 추가.
릴리즈 시 `/new-version` 스킬이 버전 섹션으로 이동.

| 커밋 타입 | CHANGELOG 카테고리 |
|----------|-------------------|
| feat | Added |
| fix | Fixed |
| improve | Changed |
| refactor | Changed |
| chore(deps) | Changed |

### 스타일
- 간결하게. 부연설명 최소화
- 괄호 안 기술 상세 생략
- 한 줄에 하나의 변경사항

### 예시
```
나쁜 예 (장황):
- wxPython 기반 GUI 및 시스템 트레이 아이콘
- 설정 다이얼로그 (핫키 커스터마이징, 상태 표시, 정보 탭)

좋은 예 (간결):
- GUI 및 트레이 아이콘
- 설정 다이얼로그
```

---

## 문서 업데이트 지침

### 업데이트 트리거

코드 변경 시 관련 문서도 함께 업데이트해야 한다.

| 변경 유형 | 업데이트 대상 문서 |
|----------|------------------|
| 새 모듈/파일 추가 | `ARCHITECTURE.md` (모듈 구조 섹션) |
| 새 기능 추가 | `ARCHITECTURE.md` (컴포넌트), `kakaotalk_a11y_guide.md` |
| 핫키 변경 | `ARCHITECTURE.md` (HotkeyManager), `BUILD.md` (실행 방법) |
| 빌드 설정 변경 | `BUILD.md` |
| 디버그 기능 변경 | `TOOLS_GUIDE.md`, `ARCHITECTURE.md` (부록) |
| UIA 관련 변경 | `KAKAO_UIA_QUIRKS.md`, `UIA_완전_가이드.md` |
| 의존성 추가/제거 | `BUILD.md` (요구사항) |
| GUI 변경 | `ARCHITECTURE.md` (gui/ 구조), `BUILD.md` (실행 방법) |

### docs/ 폴더 문서별 책임

| 문서 | 주요 내용 | 업데이트 기준 |
|------|----------|-------------|
| `ARCHITECTURE.md` | 모듈 구조, 컴포넌트, 데이터 흐름, 설계 결정 | 코드 구조 변경 시 |
| `BUILD.md` | 빌드/실행 방법, 의존성, 배포 | 빌드/배포 관련 변경 시 |
| `TOOLS_GUIDE.md` | 디버그 도구, 단축키, 분석 방법 | 디버그 기능 변경 시 |
| `kakaotalk_a11y_guide.md` | 사용자 가이드, 기능 설명 | UI/기능 변경 시 |
| `KAKAO_UIA_QUIRKS.md` | 카카오톡 UIA 특이사항 | UIA 우회 방법 변경 시 |
| `PROFILER_ANALYSIS.md` | 성능 분석 결과 | 프로파일링 후 |

### 업데이트 절차

1. **영향 분석**: 코드 변경 완료 후 위 표를 참고하여 영향받는 문서 식별
2. **문서 읽기**: 해당 문서에서 관련 섹션 찾기
3. **변경 반영**: 추가/수정/삭제
4. **로드맵 정리**: 향후 계획 섹션에서 완료된 항목 제거 또는 업데이트

### 주의사항

- 문서 커밋은 코드 커밋과 분리해도 됨
- 큰 기능은 코드와 문서를 함께 커밋해도 됨
- 문서만 변경하면 `docs:` 또는 `docs(<문서명>):` 타입 사용
- 프롬프트 문서(`카카오톡_*.md`)는 일반적으로 업데이트 불필요

---

## 브랜치 전략

### 현재 (단일 개발자)
- `main` 브랜치에 직접 커밋

### 필요시 브랜치 사용
```
feat/<기능명>   # 새 기능
fix/<버그명>    # 버그 수정
refactor/<대상> # 리팩토링
```

### 워크플로우 (브랜치 사용 시)
1. `git checkout -b feat/<name>`
2. 작업 및 커밋
3. 테스트 검증
4. `git checkout main && git merge feat/<name>`
5. `git branch -d feat/<name>`

---

## 배포 워크플로우

### 저장소 구조
- **개발 저장소**: 상세 커밋 이력 유지
- **배포 저장소**: GitHub 공개용

### 동기화 원칙
1. 코드/문서 내용은 양쪽 동일하게 유지
2. 배포 시 여러 커밋을 하나로 합칠 수 있음 (squash)
3. 커밋 이력만 다를 수 있음

### 배포 절차

상세 체크리스트: [RELEASING.md](../../docs/RELEASING.md)
